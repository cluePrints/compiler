<?xml version="1.0" encoding="utf-8"?>
<mx:VBox horizontalAlign="center"
	xmlns:mx="http://www.adobe.com/2006/mxml"
	creationComplete="refresh()" width="100%" height="100%">
	<mx:HTTPService id="reportSvc" 
		useProxy="false"
		method="GET"
		url="{mainDataSvcUrl}"
		result="httpResultHandler(event)"
		fault="httpFaultHandler(event)"/>
	<mx:Script>
		<![CDATA[
			import mx.managers.PopUpManager;
			import components.util.ReloaderPopup;
			import components.Util;
			import mx.collections.ArrayCollection;
			
			[Bindable]			
			public var devicesState:ArrayCollection = new ArrayCollection();
			public var mainDataSvcUrl:String;
			
			public function refresh():void{
				reportSvc.cancel();
				reportSvc.send(null);
			}			
			
			var util:Util = new Util();
			function httpFaultHandler(event:*):void {
				var p:ReloaderPopup = new ReloaderPopup();
				p.width = this.width;
				p.height = this.height
				PopUpManager.addPopUp(p, this, true);
			}
			
			function httpResultHandler(event:*):void {
				if (event.result.internalServerError != null) {
					httpFaultHandler(event);
					return;
				}
				devicesState = event.result.availableDevicesReport;
			}			
		]]>
	</mx:Script>
		
	<mx:VBox
		width="100%"
		height="100%">
		<mx:BarChart 
			width="100%"
			height="100%">
			<mx:series>				
				<mx:BarSeries yField="productionPlan" xField=""/>
			</mx:series>
		</mx:BarChart>
	</mx:VBox>
</mx:VBox>
