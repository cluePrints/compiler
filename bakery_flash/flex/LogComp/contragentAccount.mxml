<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="520" height="384" fontSize="24" creationComplete="init()">
<mx:HTTPService id="moneyMoveSvc" 
		useProxy="false"
		method="POST"
		url="http://localhost:8080/bakery/svc.htm?svc=org.bakery.server.controllers.svc.impl.MoneyMoveSvc"
		result="httpResultHandler(event)"
		fault="httpFaultHandler(event)"/>

<mx:Script>
<![CDATA[
	import LogComp.Util;
	 private var mainData:*;
	 private var orders:*; 
	 private var contragent:*; 
	 private var accounts:*;
	 var util:Util = new Util();
	function init(){
		formModel.mode = "FETCH";
		moneyMoveSvc.cancel();
		moneyMoveSvc.send(formModel);
	}
	function httpResultHandler(event:*){
		
		accounts = util.extractItemCollection(event.result.accounts, 'account');
		orders = util.extractItemCollection(event.result.orders, 'order');
	mx.controls.Alert.show(accounts+"     "+orders);
	}
	 function httpFaultHandler(event:Event):void{
					 mx.controls.Alert.show(event.toString())	;
			
			} 
	function clearAll(){
		contragentName.selectedIndex = 0;
		orderName.selectedIndex = 0;
		date.text = "";
	}
		]]>
</mx:Script>
	<mx:Model id="formModel">		
		<root>
			<mode></mode>
			<id>{}</id>
			<destinationAccount>{}</destinationAccount>
			<sourceAccount>{}</sourceAccount>
			<amount>{}</amount>		
			<active>{}</active>	
			<date>{}</date>
			<order>{}</order>
			<price>{}</price>
			<desc>{}</desc>
			
		</root>		
	</mx:Model>	
	<mx:Label text="ОПЛАТА СЧЕТА КОНТРАГЕНТОМ" x="58.5" y="10" fontSize="14" fontWeight="bold"/>
	<mx:VBox x="10" y="53" height="100%" width="510">
	<mx:FormItem label="Контрагент" width="90%" fontWeight="bold" fontSize="10">
		<mx:ComboBox id="contragentName" 
		dataProvider="{accounts}"
		labelField = "owner"	
		 width="95%" 
		 fontWeight="normal"/>
	</mx:FormItem>
	<mx:FormItem label="Заказ" width="90%" fontWeight="bold" fontSize="10">
		<mx:ComboBox id="orderName"
			dataProvider="{orders}"
			labelField = "textView"
			 width="95%"
			 fontWeight="normal"/>
	</mx:FormItem>
	<mx:FormItem label="Дата перевода" width="90%" fontWeight="bold" fontSize="10">
		<mx:DateField id="date" fontWeight="normal" formatString="DD/MM/YY"/>
		
	</mx:FormItem>
	<mx:HBox width="100%">
		<mx:Button label="Перечислить"  fontSize="10"/>
		<mx:Button label="Очистить"  click="clearAll()" fontSize="10"/>
		<mx:Button label="Выход" fontSize="10"/>
	</mx:HBox>
	</mx:VBox>
</mx:Canvas>
